SELECT
CASE
   WHEN sgsn_mcc_mnc IN ('44076','44071','44053','44008','44077','44072','44054','44007','44079','44073','44055','44050','44088','44074','44070','44051','44089','4075','44056','44052','44170','44083','44085','44081','44080','44086','44084','44082') THEN 'KDDI Corporation (jp)'
   ELSE 'OTHER'
END AS NETWORK,
sgsn_mcc_mnc as MCC_MNC,
COUNT(distinct subscriber_key) as NUMBER_OF_MSISDN ,
day_date as DATE,
period_hour_key AS PERIOD_HOUR,
CAST(SUM(volume_in/1024/1024/1024) AS DECIMAL(100,2)) as VOLUME_IN_GB,
CAST(SUM(volume_out/1024/1024/1024) AS DECIMAL(100,2)) as VOLUME_OUT_GB,
CAST((SUM(volume_in/1024/1024/1024) + SUM(volume_out/1024/1024/1024)) AS DECIMAL(100,2)) as TOTAL_VOLUME_GB

FROM  PROD.DWH_FACT_CONV_AGG_HOUR

WHERE to_char(day_date,'YYYY-MM-DD') = to_char(getdate(),'YYYY-MM-DD')
and sgsn_mcc_mnc IN ('44076','44071','44053','44008','44077','44072','44054','44007','44079','44073','44055','44050','44088','44074','44070','44051','44089','44075','44056','44052','44170')
GROUP BY 2,4,5
ORDER BY 4,5 ASC;



